/*Average rental duration and total revenues by category */

SELECT	
	C.name,
	ROUND(AVG(rental_duration), 2) AS average_rental_duration,
	SUM(PY.amount) AS total_revenue
FROM	
	film F
	INNER JOIN inventory I ON F.film_id = I.film_id
	INNER JOIN rental R ON I.inventory_id = R.inventory_id
	INNER JOIN payment PY ON R.rental_id = PY.rental_id
	INNER JOIN film_category FC ON F.film_id = FC.film_id
	INNER JOIN category C ON FC.category_id = C.category_id
	
GROUP BY 	
	C.name
ORDER BY 	
	total_revenue DESC
;	
